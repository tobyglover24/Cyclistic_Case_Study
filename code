CREATE TABLE `alien-cedar-441716-t6.cyclistic.final_divvy_tripdata` AS (
SELECT 
  *,
  CASE
    EXTRACT (DAYOFWEEK FROM started_at)
      WHEN 1 THEN 'SUN'
      WHEN 2 THEN 'MON'
      WHEN 3 THEN 'TUE'
      WHEN 4 THEN 'WED'
      WHEN 5 THEN 'THU'
      WHEN 6 THEN 'FRI'
      WHEN 7 THEN 'SAT'
    END AS day_of_week,
   CASE 
    EXTRACT (MONTH FROM started_at)
      WHEN 1 THEN 'Jan'
      WHEN 2 THEN 'Feb'
      WHEN 3 THEN 'Mar'
      WHEN 4 THEN 'Apr'
      WHEN 5 THEN 'May'
      WHEN 6 THEN 'Jun'
      WHEN 7 THEN 'Jul'
      WHEN 8 THEN 'Aug'
      WHEN 9 THEN 'Sep'
      WHEN 10 THEN 'Oct'
      WHEN 11 THEN 'Nov'
      WHEN 12 THEN 'Dec'
    END AS month 
 FROM `alien-cedar-441716-t6.cyclistic.clean_divvy_tripdata`
WHERE 
  start_station_name IS NOT NULL AND 
  end_station_name IS NOT NULL AND 
  end_lat IS NOT NULL AND
  ride_length >= 1 AND ride_length <= 1440
)

